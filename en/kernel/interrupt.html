<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Interrupt | Huawei LiteOS | English Site</title>
    <meta name="description" content="A Lightweight IoT Operating System that Makes Everything Around Us Smart">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.f1c36acb.css" as="style"><link rel="preload" href="/assets/js/app.33a5764c.js" as="script"><link rel="preload" href="/assets/js/24.84d7b76d.js" as="script"><link rel="prefetch" href="/assets/js/2.20e64be0.js"><link rel="prefetch" href="/assets/js/3.c73c47b0.js"><link rel="prefetch" href="/assets/js/4.830424c3.js"><link rel="prefetch" href="/assets/js/5.f9800a44.js"><link rel="prefetch" href="/assets/js/6.6d4fb2db.js"><link rel="prefetch" href="/assets/js/7.e3f71e19.js"><link rel="prefetch" href="/assets/js/8.ed38826a.js"><link rel="prefetch" href="/assets/js/9.13aa0050.js"><link rel="prefetch" href="/assets/js/10.310cbd5c.js"><link rel="prefetch" href="/assets/js/11.1c27b65d.js"><link rel="prefetch" href="/assets/js/12.363ec7ed.js"><link rel="prefetch" href="/assets/js/13.c8ba8d27.js"><link rel="prefetch" href="/assets/js/14.52e6136d.js"><link rel="prefetch" href="/assets/js/15.5bc6a253.js"><link rel="prefetch" href="/assets/js/16.50d29923.js"><link rel="prefetch" href="/assets/js/17.e942ca60.js"><link rel="prefetch" href="/assets/js/18.63f827e2.js"><link rel="prefetch" href="/assets/js/19.561a06ce.js"><link rel="prefetch" href="/assets/js/20.822c89f7.js"><link rel="prefetch" href="/assets/js/21.1b737bb6.js"><link rel="prefetch" href="/assets/js/22.50784b81.js"><link rel="prefetch" href="/assets/js/23.6d3ce5bc.js"><link rel="prefetch" href="/assets/js/25.9af98cef.js"><link rel="prefetch" href="/assets/js/26.09b076ce.js"><link rel="prefetch" href="/assets/js/27.14422ca1.js"><link rel="prefetch" href="/assets/js/28.76d0f557.js"><link rel="prefetch" href="/assets/js/29.3de41018.js"><link rel="prefetch" href="/assets/js/30.9d6b307c.js"><link rel="prefetch" href="/assets/js/31.fff19707.js"><link rel="prefetch" href="/assets/js/32.d779c224.js"><link rel="prefetch" href="/assets/js/33.e5eff646.js"><link rel="prefetch" href="/assets/js/34.c29c7bf0.js"><link rel="prefetch" href="/assets/js/35.3d453bad.js"><link rel="prefetch" href="/assets/js/36.d2a3f928.js"><link rel="prefetch" href="/assets/js/37.bab64800.js"><link rel="prefetch" href="/assets/js/38.80b00fd1.js"><link rel="prefetch" href="/assets/js/39.12b69bd3.js"><link rel="prefetch" href="/assets/js/40.8df75237.js"><link rel="prefetch" href="/assets/js/41.68b7a88d.js"><link rel="prefetch" href="/assets/js/42.9d73e1f4.js"><link rel="prefetch" href="/assets/js/43.accc44c7.js"><link rel="prefetch" href="/assets/js/44.f9c729f0.js"><link rel="prefetch" href="/assets/js/45.675d9159.js"><link rel="prefetch" href="/assets/js/46.f14efcb4.js"><link rel="prefetch" href="/assets/js/47.2a4e96c0.js"><link rel="prefetch" href="/assets/js/48.d9ed0168.js"><link rel="prefetch" href="/assets/js/49.3de65caf.js"><link rel="prefetch" href="/assets/js/50.c29ff2f9.js"><link rel="prefetch" href="/assets/js/51.e9ffed00.js"><link rel="prefetch" href="/assets/js/52.0e33188d.js"><link rel="prefetch" href="/assets/js/53.6748ca27.js"><link rel="prefetch" href="/assets/js/54.000288f1.js"><link rel="prefetch" href="/assets/js/55.8e86f10b.js"><link rel="prefetch" href="/assets/js/56.974a5063.js"><link rel="prefetch" href="/assets/js/57.8addd7b0.js"><link rel="prefetch" href="/assets/js/58.6a7d69e5.js"><link rel="prefetch" href="/assets/js/59.f920c55c.js"><link rel="prefetch" href="/assets/js/60.3e855454.js"><link rel="prefetch" href="/assets/js/61.2c67da1a.js"><link rel="prefetch" href="/assets/js/62.70c63f5c.js"><link rel="prefetch" href="/assets/js/63.f08b7541.js"><link rel="prefetch" href="/assets/js/64.4a6eb56d.js"><link rel="prefetch" href="/assets/js/65.9a9d6083.js"><link rel="prefetch" href="/assets/js/66.b4e5888f.js"><link rel="prefetch" href="/assets/js/67.cf26ea6b.js"><link rel="prefetch" href="/assets/js/68.8c8e5f15.js"><link rel="prefetch" href="/assets/js/69.ca89d6a5.js"><link rel="prefetch" href="/assets/js/70.3156a0a1.js"><link rel="prefetch" href="/assets/js/71.4ce9c97a.js"><link rel="prefetch" href="/assets/js/72.15d9939d.js"><link rel="prefetch" href="/assets/js/73.abd6ee41.js"><link rel="prefetch" href="/assets/js/74.137cf10c.js"><link rel="prefetch" href="/assets/js/75.f4fe6791.js"><link rel="prefetch" href="/assets/js/76.c805d732.js"><link rel="prefetch" href="/assets/js/77.d090efc7.js"><link rel="prefetch" href="/assets/js/78.05b90bf2.js"><link rel="prefetch" href="/assets/js/79.30077ffe.js"><link rel="prefetch" href="/assets/js/80.2e75f2d9.js"><link rel="prefetch" href="/assets/js/81.0155e2da.js"><link rel="prefetch" href="/assets/js/82.9a88acc0.js"><link rel="prefetch" href="/assets/js/83.0c1ca7e6.js"><link rel="prefetch" href="/assets/js/84.a735b6ee.js"><link rel="prefetch" href="/assets/js/85.7d237602.js"><link rel="prefetch" href="/assets/js/86.3cee3381.js"><link rel="prefetch" href="/assets/js/87.dd42373a.js"><link rel="prefetch" href="/assets/js/88.a5346047.js"><link rel="prefetch" href="/assets/js/89.ebd48bf9.js"><link rel="prefetch" href="/assets/js/90.03c0566d.js"><link rel="prefetch" href="/assets/js/91.4ea972ff.js"><link rel="prefetch" href="/assets/js/92.b9a4136c.js"><link rel="prefetch" href="/assets/js/93.0e8aa733.js"><link rel="prefetch" href="/assets/js/94.28883f14.js"><link rel="prefetch" href="/assets/js/95.8fa3c806.js"><link rel="prefetch" href="/assets/js/96.7a7d94af.js"><link rel="prefetch" href="/assets/js/97.482f7a92.js"><link rel="prefetch" href="/assets/js/98.7a77028b.js"><link rel="prefetch" href="/assets/js/99.9b8e08b3.js"><link rel="prefetch" href="/assets/js/100.b147d04f.js"><link rel="prefetch" href="/assets/js/101.cf4e724d.js"><link rel="prefetch" href="/assets/js/102.a31d0525.js"><link rel="prefetch" href="/assets/js/103.0d5bf65f.js"><link rel="prefetch" href="/assets/js/104.b6c77f30.js"><link rel="prefetch" href="/assets/js/105.81dd17e2.js"><link rel="prefetch" href="/assets/js/106.eb6d021a.js"><link rel="prefetch" href="/assets/js/107.849885a5.js"><link rel="prefetch" href="/assets/js/108.3fab7544.js"><link rel="prefetch" href="/assets/js/109.758e1008.js"><link rel="prefetch" href="/assets/js/110.98027808.js"><link rel="prefetch" href="/assets/js/111.faf1c6ce.js"><link rel="prefetch" href="/assets/js/112.4d566467.js"><link rel="prefetch" href="/assets/js/113.459d70fe.js"><link rel="prefetch" href="/assets/js/114.999f3f82.js"><link rel="prefetch" href="/assets/js/115.113c2659.js"><link rel="prefetch" href="/assets/js/116.8bdb9b2a.js"><link rel="prefetch" href="/assets/js/117.fa5ebe43.js"><link rel="prefetch" href="/assets/js/118.6b688361.js"><link rel="prefetch" href="/assets/js/119.51412ca6.js"><link rel="prefetch" href="/assets/js/120.faf7400d.js"><link rel="prefetch" href="/assets/js/121.f122eea3.js"><link rel="prefetch" href="/assets/js/122.8937d7a9.js"><link rel="prefetch" href="/assets/js/123.dfb67b87.js"><link rel="prefetch" href="/assets/js/124.100f9597.js"><link rel="prefetch" href="/assets/js/125.b8855529.js"><link rel="prefetch" href="/assets/js/126.77806c08.js"><link rel="prefetch" href="/assets/js/127.5c8795bd.js"><link rel="prefetch" href="/assets/js/128.a279b147.js"><link rel="prefetch" href="/assets/js/129.31709c6f.js"><link rel="prefetch" href="/assets/js/130.4debfe3e.js"><link rel="prefetch" href="/assets/js/131.c70f2dcc.js"><link rel="prefetch" href="/assets/js/132.ae62365d.js"><link rel="prefetch" href="/assets/js/133.d5aeef62.js"><link rel="prefetch" href="/assets/js/134.435a8b0d.js"><link rel="prefetch" href="/assets/js/135.4453e747.js"><link rel="prefetch" href="/assets/js/136.bff65f24.js"><link rel="prefetch" href="/assets/js/137.b917384e.js"><link rel="prefetch" href="/assets/js/138.269564e3.js"><link rel="prefetch" href="/assets/js/139.fcbad941.js"><link rel="prefetch" href="/assets/js/140.b7f0fb71.js"><link rel="prefetch" href="/assets/js/141.5a641bf8.js"><link rel="prefetch" href="/assets/js/142.ddfa8646.js"><link rel="prefetch" href="/assets/js/143.90692d4f.js"><link rel="prefetch" href="/assets/js/144.c8deac22.js"><link rel="prefetch" href="/assets/js/145.41f82b8e.js"><link rel="prefetch" href="/assets/js/146.b5cd71e3.js"><link rel="prefetch" href="/assets/js/147.f448da67.js"><link rel="prefetch" href="/assets/js/148.c6c05147.js"><link rel="prefetch" href="/assets/js/149.81667c5c.js"><link rel="prefetch" href="/assets/js/150.a446fa72.js"><link rel="prefetch" href="/assets/js/151.40c60d2e.js"><link rel="prefetch" href="/assets/js/152.34f5ee11.js"><link rel="prefetch" href="/assets/js/153.5f4fa74c.js"><link rel="prefetch" href="/assets/js/154.3f0b71da.js"><link rel="prefetch" href="/assets/js/155.5e3690e2.js"><link rel="prefetch" href="/assets/js/156.77e09f25.js"><link rel="prefetch" href="/assets/js/157.dc328abe.js"><link rel="prefetch" href="/assets/js/158.8ef504f4.js"><link rel="prefetch" href="/assets/js/159.3fdd263e.js"><link rel="prefetch" href="/assets/js/160.37baabe7.js"><link rel="prefetch" href="/assets/js/161.687575c2.js"><link rel="prefetch" href="/assets/js/162.0134b72b.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.32b4aeae.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f1c36acb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en/" class="home-link router-link-active"><!----> <span class="site-name">Huawei LiteOS | English Site</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/en/kernel/" class="nav-link router-link-active">Kernel Develop Guide</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">SDK Develop Guide</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/sdk/" class="nav-link">SDK Develop Guide</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kernel/interrupt.html" class="nav-link">简体中文</a></li><li class="dropdown-item"><!----> <a href="/en/kernel/interrupt.html" class="nav-link router-link-exact-active router-link-active">English</a></li></ul></div></div> <a href="https://github.com/LiteOS/LiteOS_Documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/en/kernel/" class="nav-link router-link-active">Kernel Develop Guide</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">SDK Develop Guide</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/sdk/" class="nav-link">SDK Develop Guide</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kernel/interrupt.html" class="nav-link">简体中文</a></li><li class="dropdown-item"><!----> <a href="/en/kernel/interrupt.html" class="nav-link router-link-exact-active router-link-active">English</a></li></ul></div></div> <a href="https://github.com/LiteOS/LiteOS_Documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Guide</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/en/kernel/" class="sidebar-link">Overview</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Basic Kernel</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/en/kernel/task.html" class="sidebar-link">Task</a></li><li><a href="/en/kernel/memory.html" class="sidebar-link">Memory</a></li><li><a href="/en/kernel/interrupt.html" class="active sidebar-link">Interrupt</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/kernel/interrupt.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/en/kernel/interrupt.html#development-guidelines" class="sidebar-link">Development Guidelines</a></li><li class="sidebar-sub-header"><a href="/en/kernel/interrupt.html#precautions" class="sidebar-link">Precautions</a></li><li class="sidebar-sub-header"><a href="/en/kernel/interrupt.html#programming-example" class="sidebar-link">Programming Example</a></li></ul></li><li><a href="/en/kernel/queue.html" class="sidebar-link">Queue</a></li><li><a href="/en/kernel/event.html" class="sidebar-link">Event</a></li><li><a href="/en/kernel/mutex.html" class="sidebar-link">Mutex</a></li><li><a href="/en/kernel/semaphore.html" class="sidebar-link">Semaphore</a></li><li><a href="/en/kernel/time-magmt.html" class="sidebar-link">Time Management</a></li><li><a href="/en/kernel/swtmr.html" class="sidebar-link">Software Timers</a></li><li><a href="/en/kernel/list.html" class="sidebar-link">Doubly-Linked List</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>ErrorCode Reference</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/en/kernel/errorcode-task.html" class="sidebar-link">Task Error Codes</a></li><li><a href="/en/kernel/errorcode-queue.html" class="sidebar-link">Queue Error Code</a></li><li><a href="/en/kernel/errorcode-event.html" class="sidebar-link">Event Error Codes</a></li><li><a href="/en/kernel/errorcode-mutex.html" class="sidebar-link">Mutex Error Code</a></li><li><a href="/en/kernel/errorcode-semaphore.html" class="sidebar-link">Semaphore Error Codes</a></li><li><a href="/en/kernel/errorcode-swtmr.html" class="sidebar-link">Software Timer Error Codes</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="interrupt"><a href="#interrupt" aria-hidden="true" class="header-anchor">#</a> Interrupt</h1> <p></p><div class="table-of-contents"><ul><li><a href="#overview">Overview</a><ul><li><a href="#basic-concept">Basic Concept</a></li><li><a href="#introduce-of-interrupt">Introduce of Interrupt</a></li><li><a href="#terminology-associated-with-interrupt">Terminology Associated With Interrupt</a></li></ul></li><li><a href="#development-guidelines">Development Guidelines</a><ul><li><a href="#usage-scenarios">Usage Scenarios</a></li><li><a href="#functions">Functions</a></li><li><a href="#development-process">Development Process</a></li></ul></li><li><a href="#precautions">Precautions</a></li><li><a href="#programming-example">Programming Example</a><ul><li><a href="#example-description">Example Description</a></li><li><a href="#example-code">Example Code</a></li><li><a href="#verification">Verification</a></li></ul></li></ul></div><p></p> <h2 id="overview"><a href="#overview" aria-hidden="true" class="header-anchor">#</a> Overview</h2> <h3 id="basic-concept"><a href="#basic-concept" aria-hidden="true" class="header-anchor">#</a> Basic Concept</h3> <p>When a condition that needs immediate attention occurs, the CPU suspends current activities and switches to deal with the condition.</p> <p>The CPU runs faster than external peripherals. When external peripherals are able to fulfill an activity alone, the CPU takes care of other activities.</p> <p>When the CPU must be involved in fulfilling an activity, the interrupt mechanism enables an external peripheral to emit an interrupt signal to alert the CPU of the high-priority condition requiring the interruption of current activities. The CPU does not need to keep waiting for peripheral states, thereby improving CPU efficiency and accelerating system response.</p> <p>The interrupt mechanism supports:</p> <ul><li><p>Initialize</p></li> <li><p>Create</p></li> <li><p>Lock or unlock</p></li> <li><p>Restore</p></li> <li><p>Enable</p></li> <li><p>Disable</p></li></ul> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>The interrupt mechanism of Huawei LiteOS is based on interrupt.</p></div> <h3 id="introduce-of-interrupt"><a href="#introduce-of-interrupt" aria-hidden="true" class="header-anchor">#</a> Introduce of Interrupt</h3> <p>The following three types of hardware are involved in the interrupt mechanism:</p> <ul><li><p><strong>Device</strong>:  the interrupt source. When a device requests the help of the CPU, it emits an interrupt signal to the interrupt controller.</p></li> <li><p><strong>Interrupt controller</strong>:  a type of peripheral that sends an interrupt request to the CPU after receiving an interrupt signal from the interrupt pins of other peripherals. On the interrupt controller, you can prioritize, enable, or disable interrupt sources, as well as specify an interrupt trigger mode on each interrupt source. Common interrupt controllers include the Vector Interrupt Controller (VIC) and General Interrupt Controller (GIC, typically used in ARM Cortex-A7).</p></li> <li><p><strong>CPU</strong>:  executes an interrupt handler at the request of an interrupt source.</p></li></ul> <h3 id="terminology-associated-with-interrupt"><a href="#terminology-associated-with-interrupt" aria-hidden="true" class="header-anchor">#</a> Terminology Associated With Interrupt</h3> <ul><li><p><strong>Interrupt ID</strong>: a unique identifier contained in all interrupt requests from a particular interrupt source.</p></li> <li><p><strong>Interrupt request (IRQ)</strong>: an electrical pulse signal sent to alert the CPU of an urgent condition. The CPU suspends current activities and deals with the condition that needs immediate attention.</p></li> <li><p><strong>Interrupt priority</strong>: the priority of an interrupt source. Interrupt priority is determined based on importance and urgency. Huawei LiteOS supports the interrupt priority and interrupt nesting of the interrupt controller. Interrupt management does not limit the priority and nesting.</p></li> <li><p><strong>Interrupt handler</strong>: When an external peripheral generates an interrupt request, the CPU executes an interrupt handler to switch from current activities to the event that needs immediate attention.</p></li> <li><p><strong>Interrupt trigger</strong>: set to 1 when an interrupt source emits an interrupt signal.</p></li> <li><p><strong>Interrupt trigger type</strong>: the way in which an interrupt signal is sent to the interrupt controller. Typically, an interrupt signal is either level-triggered or edge-triggered.</p></li> <li><p><strong>Interrupt vector</strong>: starting address of interrupt service routine.</p></li> <li><p><strong>Interrupt vector table</strong>: a table where interrupt vectors are stored based on interrupt ID.</p></li></ul> <h2 id="development-guidelines"><a href="#development-guidelines" aria-hidden="true" class="header-anchor">#</a> Development Guidelines</h2> <h3 id="usage-scenarios"><a href="#usage-scenarios" aria-hidden="true" class="header-anchor">#</a> Usage Scenarios</h3> <p>When an interrupt request is generated, the CPU responds by suspending current activities and calling the user-defined interrupt handler to deal with the condition that needs immediate attention.</p> <h3 id="functions"><a href="#functions" aria-hidden="true" class="header-anchor">#</a> Functions</h3> <p>The interrupt module provides the following functions:</p> <table><thead><tr><th><strong>API</strong></th> <th><strong>Description</strong></th></tr></thead> <tbody><tr><td><code>LOS_HwiCreate</code></td> <td>Creates a hardware interrupt to register the corresponding interrupt handler</td></tr> <tr><td><code>LOS_IntUnLock</code></td> <td>Unlocks an interrupt</td></tr> <tr><td><code>LOS_IntRestore</code></td> <td>Restores an interrupt</td></tr> <tr><td><code>LOS_IntLock</code></td> <td>Locks an interrupt</td></tr> <tr><td><code>LOS_HwiDelete</code></td> <td>Deletes a hard interrupt</td></tr></tbody></table> <h3 id="development-process"><a href="#development-process" aria-hidden="true" class="header-anchor">#</a> Development Process</h3> <ol><li>Configure the following parameters:</li></ol> <ul><li><p><code>LOSCFG_PLATFORM_HWI</code>: a switch to enable or disable the hardware interrupt module. Set to YES.</p></li> <li><p><code>LOSCFG_PLATFORM_HWI_LIMIT</code>: the maximum allowed number of hardware interrupts.</p></li></ul> <ol start="2"><li><p>Call the <code>LOS_HwiInit</code> API to initialize the interrupt mechanism.</p></li> <li><p>Call the <code>LOS_HwiCreate</code> API to create an interrupt. Enabel the specified interrupt as required.</p></li> <li><p>Call the <code>LOS_HwiDelete</code> API to delete an interrupt.</p></li></ol> <h2 id="precautions"><a href="#precautions" aria-hidden="true" class="header-anchor">#</a> Precautions</h2> <ul><li><p>The register address of the <code>LosHwiInit</code> operation and the maximum allowed number of interrupts vary depending on hardware specifications.</p></li> <li><p>Avoid long-running interrupt handlers because they have negative impact on CPU's response to interrupts.</p></li> <li><p>The function leading to schedule cannot be performed after breading off.</p></li> <li><p>The input parameter of the <code>LOS_IntRestore()</code> API must be the PRIMASK that is saved by the <code>LOS_IntLock()</code> API before locking the interrupt.</p></li> <li><p>In Cortex-A7, interrupts 0–31 are for internal use and it is not advisable to request or create them.</p></li></ul> <h2 id="programming-example"><a href="#programming-example" aria-hidden="true" class="header-anchor">#</a> Programming Example</h2> <h3 id="example-description"><a href="#example-description" aria-hidden="true" class="header-anchor">#</a> Example Description</h3> <p>The programming example will cover the following functions:</p> <ol><li><p>Initialize an hardware interrupt</p></li> <li><p>Register an interrupt</p></li> <li><p>Trigger an interrupt</p></li> <li><p>View the output</p></li></ol> <p><strong>Prerequisite:</strong></p> <ul><li><p>The <code>LOSCFG_PLATFORM_HWI</code> parameter in the los_config.h file is set to <strong>YES</strong>.</p></li> <li><p>The <code>OS_HWI_MAX_USED_NUM</code> parameter in the los_config.h file is set to the maximum number of hardware interrupts the operating system allows.</p></li></ul> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>The current interrupt test code provides a basic framework. The interrupt hardware initialization code can be implemented by calling the <code>Example_Exti0_Init()</code> function based on the hardware of the development board.</p></div> <h3 id="example-code"><a href="#example-code" aria-hidden="true" class="header-anchor">#</a> Example Code</h3> <p>The code is as follows:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Example_Exti0_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">/*add your IRQ init code here*/</span>

    <span class="token keyword">return</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token keyword">static</span> VOID <span class="token function">User_IRQHandler</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\r\n User IRQ test\r\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

UINT32 <span class="token function">Example_Interrupt</span><span class="token punctuation">(</span>VOID<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    UINTPTR uvIntSave<span class="token punctuation">;</span>
    uvIntSave <span class="token operator">=</span> <span class="token function">LOS_IntLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token function">Example_Exti0_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token function">LOS_HwiCreate</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> User_IRQHandler<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//create interrupt</span>
    
    <span class="token function">LOS_IntRestore</span><span class="token punctuation">(</span>uvIntSave<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> LOS_OK<span class="token punctuation">;</span>
<span class="token punctuation">}</span>  
</code></pre></div><h3 id="verification"><a href="#verification" aria-hidden="true" class="header-anchor">#</a> Verification</h3> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIsAAAAbCAIAAADDHevrAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAFlSURBVGhD7ZlREsIwCER7/2Pqn5fQsXU6kQQCiIiZ7ZdTk0L2LSTTbpfr7Y6rsAIbCBWm80wNhIoDAqHqgEAIhMorUD3BwT607deRePs7YSlHOBK0vXkm1qanT1I/Ul5s1HM0ktYiNPQE5xiHk6KUjXpOPCHOzoL3rbXYLz6KEEm+Lcdh/qddSFkLz9Eobh1jqCHOOFMF+8YlZPk9QlzTnubfZ1u0hnyEyM4xdRBHiNufTDU6XMI6hEjVn1pzVe8zmlBD5K+ofcjd/aZuCxlg6HJtPI064YRIm9LkQDSa1hCnqWCOEAxS2+/fy2lWbh2jX8Zv96H/IKTsZn1JfW604ZlKcAN3BpueRIapCjf73dQRWm/TN20XeLfta6c+vfJnLfJue2FIixDKt3ZaRBBKk9oZCIScwqVNA6E0qZ2BQMgpXNo0EEqT2hkIhJzCpU17fUtNi4dAVgVAyKpY9ngQylbcGu8BzipJkg3YgwQAAAAASUVORK5CYII=" alt></p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/LiteOS/LiteOS_Documents/edit/master/docs/en/kernel/interrupt.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">8/5/2018, 5:13:52 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/en/kernel/memory.html" class="prev">
          Memory
        </a></span> <span class="next"><a href="/en/kernel/queue.html">
          Queue
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/24.84d7b76d.js" defer></script><script src="/assets/js/app.33a5764c.js" defer></script>
  </body>
</html>
