<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Event | Huawei LiteOS | English Site</title>
    <meta name="description" content="A Lightweight IoT Operating System that Makes Everything Around Us Smart">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.81ce7d58.css" as="style"><link rel="preload" href="/assets/js/app.c71e3eab.js" as="script"><link rel="preload" href="/assets/js/22.f7638af3.js" as="script"><link rel="prefetch" href="/assets/js/2.6f29b60f.js"><link rel="prefetch" href="/assets/js/3.aa740300.js"><link rel="prefetch" href="/assets/js/4.9992cb9b.js"><link rel="prefetch" href="/assets/js/5.e77ba255.js"><link rel="prefetch" href="/assets/js/6.abd840c6.js"><link rel="prefetch" href="/assets/js/7.286b618f.js"><link rel="prefetch" href="/assets/js/8.eb399ca3.js"><link rel="prefetch" href="/assets/js/9.5314dd14.js"><link rel="prefetch" href="/assets/js/10.9c8ed036.js"><link rel="prefetch" href="/assets/js/11.3bc7c961.js"><link rel="prefetch" href="/assets/js/12.baa735a5.js"><link rel="prefetch" href="/assets/js/13.e2c03450.js"><link rel="prefetch" href="/assets/js/14.8aa81f0a.js"><link rel="prefetch" href="/assets/js/15.0e1e1fd0.js"><link rel="prefetch" href="/assets/js/16.5f92d673.js"><link rel="prefetch" href="/assets/js/17.e1f5157b.js"><link rel="prefetch" href="/assets/js/18.6a9c7554.js"><link rel="prefetch" href="/assets/js/19.e22f1786.js"><link rel="prefetch" href="/assets/js/20.fe57bae9.js"><link rel="prefetch" href="/assets/js/21.a43108e5.js"><link rel="prefetch" href="/assets/js/23.5da2446c.js"><link rel="prefetch" href="/assets/js/24.84753048.js"><link rel="prefetch" href="/assets/js/25.a12bd2b7.js"><link rel="prefetch" href="/assets/js/26.445bce9f.js"><link rel="prefetch" href="/assets/js/27.1f49f614.js"><link rel="prefetch" href="/assets/js/28.03ed9548.js"><link rel="prefetch" href="/assets/js/29.76cdf290.js"><link rel="prefetch" href="/assets/js/30.8984d50b.js"><link rel="prefetch" href="/assets/js/31.d6c0539c.js"><link rel="prefetch" href="/assets/js/32.8ea09927.js"><link rel="prefetch" href="/assets/js/33.8e4cec5c.js"><link rel="prefetch" href="/assets/js/34.329253bc.js"><link rel="prefetch" href="/assets/js/35.4198888a.js"><link rel="prefetch" href="/assets/js/36.f9c3db2d.js"><link rel="prefetch" href="/assets/js/37.6bb42c11.js"><link rel="prefetch" href="/assets/js/38.bf9fbe09.js"><link rel="prefetch" href="/assets/js/39.3c6b9712.js"><link rel="prefetch" href="/assets/js/40.f77a92e8.js"><link rel="prefetch" href="/assets/js/41.c88c769a.js"><link rel="prefetch" href="/assets/js/42.ff87437d.js"><link rel="prefetch" href="/assets/js/43.006ba3ce.js"><link rel="prefetch" href="/assets/js/44.94792d14.js"><link rel="prefetch" href="/assets/js/45.2fca0f41.js"><link rel="prefetch" href="/assets/js/46.c2ec41b6.js"><link rel="prefetch" href="/assets/js/47.4e409a7e.js"><link rel="prefetch" href="/assets/js/48.c43c8e39.js"><link rel="prefetch" href="/assets/js/49.bbe05d1b.js"><link rel="prefetch" href="/assets/js/50.a8dd0b33.js"><link rel="prefetch" href="/assets/js/51.762eb89c.js"><link rel="prefetch" href="/assets/js/52.03cffa6a.js"><link rel="prefetch" href="/assets/js/53.bd47ff7a.js"><link rel="prefetch" href="/assets/js/54.2e4ebdc6.js"><link rel="prefetch" href="/assets/js/55.dd6b2436.js"><link rel="prefetch" href="/assets/js/56.3d4e30f1.js"><link rel="prefetch" href="/assets/js/57.9ce53d2b.js"><link rel="prefetch" href="/assets/js/58.08f44821.js"><link rel="prefetch" href="/assets/js/59.dd851427.js"><link rel="prefetch" href="/assets/js/60.bc8eeba3.js"><link rel="prefetch" href="/assets/js/61.94939814.js"><link rel="prefetch" href="/assets/js/62.0fdfc71e.js"><link rel="prefetch" href="/assets/js/63.0f528da5.js"><link rel="prefetch" href="/assets/js/64.783796e5.js"><link rel="prefetch" href="/assets/js/65.87e1590f.js"><link rel="prefetch" href="/assets/js/66.e6f655c4.js"><link rel="prefetch" href="/assets/js/67.0c58a1f8.js"><link rel="prefetch" href="/assets/js/68.d14ce22e.js"><link rel="prefetch" href="/assets/js/69.03ea4a5d.js"><link rel="prefetch" href="/assets/js/70.3839760d.js"><link rel="prefetch" href="/assets/js/71.11de96c4.js"><link rel="prefetch" href="/assets/js/72.0ad8cbfc.js"><link rel="prefetch" href="/assets/js/73.e78a571e.js"><link rel="prefetch" href="/assets/js/74.827bb798.js"><link rel="prefetch" href="/assets/js/75.40926e25.js"><link rel="prefetch" href="/assets/js/76.b38831af.js"><link rel="prefetch" href="/assets/js/77.d1a5b9e2.js"><link rel="prefetch" href="/assets/js/78.1c5f7b0b.js"><link rel="prefetch" href="/assets/js/79.f00e4488.js"><link rel="prefetch" href="/assets/js/80.6f984431.js"><link rel="prefetch" href="/assets/js/81.6eaa1abd.js"><link rel="prefetch" href="/assets/js/82.b6bdabbf.js"><link rel="prefetch" href="/assets/js/83.9962a614.js"><link rel="prefetch" href="/assets/js/84.c38761a1.js"><link rel="prefetch" href="/assets/js/85.9f44b167.js"><link rel="prefetch" href="/assets/js/86.b18beb8f.js"><link rel="prefetch" href="/assets/js/87.30868b4d.js"><link rel="prefetch" href="/assets/js/88.ad4d3cee.js"><link rel="prefetch" href="/assets/js/89.826b6d28.js"><link rel="prefetch" href="/assets/js/90.521748da.js"><link rel="prefetch" href="/assets/js/91.e9cc7588.js"><link rel="prefetch" href="/assets/js/92.99577237.js"><link rel="prefetch" href="/assets/js/93.f3b95164.js"><link rel="prefetch" href="/assets/js/94.ed2d4c64.js"><link rel="prefetch" href="/assets/js/95.52c15509.js"><link rel="prefetch" href="/assets/js/96.6c72499c.js"><link rel="prefetch" href="/assets/js/97.074547d5.js"><link rel="prefetch" href="/assets/js/98.db7953b4.js"><link rel="prefetch" href="/assets/js/99.70169205.js"><link rel="prefetch" href="/assets/js/100.c619407e.js"><link rel="prefetch" href="/assets/js/101.e1680b02.js"><link rel="prefetch" href="/assets/js/102.27878026.js"><link rel="prefetch" href="/assets/js/103.41060cf8.js"><link rel="prefetch" href="/assets/js/104.c775317a.js"><link rel="prefetch" href="/assets/js/105.5c86b4bc.js"><link rel="prefetch" href="/assets/js/106.49b51fbd.js"><link rel="prefetch" href="/assets/js/107.9ffc9b9a.js"><link rel="prefetch" href="/assets/js/108.ca59ba6d.js"><link rel="prefetch" href="/assets/js/109.097f8702.js"><link rel="prefetch" href="/assets/js/110.ace931ea.js"><link rel="prefetch" href="/assets/js/111.2852973a.js"><link rel="prefetch" href="/assets/js/112.c9765804.js"><link rel="prefetch" href="/assets/js/113.ff2e7540.js"><link rel="prefetch" href="/assets/js/114.910efdcc.js"><link rel="prefetch" href="/assets/js/115.59ea5a32.js"><link rel="prefetch" href="/assets/js/116.78c6100d.js"><link rel="prefetch" href="/assets/js/117.9435785b.js"><link rel="prefetch" href="/assets/js/118.3f23a5de.js"><link rel="prefetch" href="/assets/js/119.51240e2a.js"><link rel="prefetch" href="/assets/js/120.a3238f09.js"><link rel="prefetch" href="/assets/js/121.d4e6fab4.js"><link rel="prefetch" href="/assets/js/122.7af42b19.js"><link rel="prefetch" href="/assets/js/123.32968629.js"><link rel="prefetch" href="/assets/js/124.43333bc8.js"><link rel="prefetch" href="/assets/js/125.7f5faea2.js"><link rel="prefetch" href="/assets/js/126.ce683643.js"><link rel="prefetch" href="/assets/js/127.b7f7f76b.js"><link rel="prefetch" href="/assets/js/128.0f7b715b.js"><link rel="prefetch" href="/assets/js/129.baebc31e.js"><link rel="prefetch" href="/assets/js/130.c310da61.js"><link rel="prefetch" href="/assets/js/131.6229417c.js"><link rel="prefetch" href="/assets/js/132.43535269.js"><link rel="prefetch" href="/assets/js/133.b7fa7346.js"><link rel="prefetch" href="/assets/js/134.ff2a791a.js"><link rel="prefetch" href="/assets/js/135.3bd44483.js"><link rel="prefetch" href="/assets/js/136.258f3cd7.js"><link rel="prefetch" href="/assets/js/137.3a66904f.js"><link rel="prefetch" href="/assets/js/138.8b6e1a44.js"><link rel="prefetch" href="/assets/js/139.f444599a.js"><link rel="prefetch" href="/assets/js/140.986f2a18.js"><link rel="prefetch" href="/assets/js/141.fafaa6de.js"><link rel="prefetch" href="/assets/js/142.44d497d7.js"><link rel="prefetch" href="/assets/js/143.272e1d29.js"><link rel="prefetch" href="/assets/js/144.c08c320e.js"><link rel="prefetch" href="/assets/js/145.d1f23734.js"><link rel="prefetch" href="/assets/js/146.2d0383d9.js"><link rel="prefetch" href="/assets/js/147.32f5537f.js"><link rel="prefetch" href="/assets/js/148.70d29288.js"><link rel="prefetch" href="/assets/js/149.5cdf2ae8.js"><link rel="prefetch" href="/assets/js/150.f01a14e4.js"><link rel="prefetch" href="/assets/js/151.7e04ccc4.js"><link rel="prefetch" href="/assets/js/152.f943ae84.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.50b59430.js">
    <link rel="stylesheet" href="/assets/css/0.styles.81ce7d58.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en/" class="home-link router-link-active"><!----> <span class="site-name">Huawei LiteOS | English Site</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/en/getting-started.html" class="nav-link">Getting Started</a></div><div class="nav-item"><a href="/en/kernel/" class="nav-link router-link-active">Develop Guide</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kernel/event.html" class="nav-link">简体中文</a></li><li class="dropdown-item"><!----> <a href="/en/kernel/event.html" class="nav-link router-link-exact-active router-link-active">English</a></li></ul></div></div> <a href="https://github.com/LiteOS/LiteOS_Documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/en/getting-started.html" class="nav-link">Getting Started</a></div><div class="nav-item"><a href="/en/kernel/" class="nav-link router-link-active">Develop Guide</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kernel/event.html" class="nav-link">简体中文</a></li><li class="dropdown-item"><!----> <a href="/en/kernel/event.html" class="nav-link router-link-exact-active router-link-active">English</a></li></ul></div></div> <a href="https://github.com/LiteOS/LiteOS_Documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Guide</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/en/kernel/" class="sidebar-link">Overview</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Basic Kernel</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/en/kernel/task.html" class="sidebar-link">Task</a></li><li><a href="/en/kernel/memory.html" class="sidebar-link">Memory</a></li><li><a href="/en/kernel/interrupt.html" class="sidebar-link">Interrupt</a></li><li><a href="/en/kernel/queue.html" class="sidebar-link">Queue</a></li><li><a href="/en/kernel/event.html" class="active sidebar-link">Event</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/kernel/event.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/en/kernel/event.html#development-guidelines" class="sidebar-link">Development Guidelines</a></li><li class="sidebar-sub-header"><a href="/en/kernel/event.html#precautions" class="sidebar-link">Precautions</a></li><li class="sidebar-sub-header"><a href="/en/kernel/event.html#programming-example" class="sidebar-link">Programming Example</a></li></ul></li><li><a href="/en/kernel/mutex.html" class="sidebar-link">Mutex</a></li><li><a href="/en/kernel/semaphore.html" class="sidebar-link">Semaphore</a></li><li><a href="/en/kernel/time-magmt.html" class="sidebar-link">Time Management</a></li><li><a href="/en/kernel/swtmr.html" class="sidebar-link">Software Timers</a></li><li><a href="/en/kernel/list.html" class="sidebar-link">Doubly-Linked List</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>ErrorCode Reference</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/en/kernel/errorcode-task.html" class="sidebar-link">Task Error Codes</a></li><li><a href="/en/kernel/errorcode-queue.html" class="sidebar-link">Queue Error Code</a></li><li><a href="/en/kernel/errorcode-event.html" class="sidebar-link">Event Error Codes</a></li><li><a href="/en/kernel/errorcode-mutex.html" class="sidebar-link">Mutex Error Code</a></li><li><a href="/en/kernel/errorcode-semaphore.html" class="sidebar-link">Semaphore Error Codes</a></li><li><a href="/en/kernel/errorcode-swtmr.html" class="sidebar-link">Software Timer Error Codes</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="event"><a href="#event" aria-hidden="true" class="header-anchor">#</a> Event</h1> <p></p><div class="table-of-contents"><ul><li><a href="#overview">Overview</a><ul><li><a href="#basic-concept">Basic Concept</a></li><li><a href="#operation-mechanism">Operation Mechanism</a></li></ul></li><li><a href="#development-guidelines">Development Guidelines</a><ul><li><a href="#usage-scenarios">Usage Scenarios</a></li><li><a href="#functions">Functions</a></li><li><a href="#development-process">Development Process</a></li></ul></li><li><a href="#precautions">Precautions</a></li><li><a href="#programming-example">Programming Example</a><ul><li><a href="#example-description">Example Description</a></li><li><a href="#example-code">Example Code</a></li><li><a href="#verification">Verification</a></li></ul></li></ul></div><p></p> <h2 id="overview"><a href="#overview" aria-hidden="true" class="header-anchor">#</a> Overview</h2> <h3 id="basic-concept"><a href="#basic-concept" aria-hidden="true" class="header-anchor">#</a> Basic Concept</h3> <p>Events are used for synchronization between tasks. A task or interrupt service routine can trigger an event (a synchronization signal) to another task through an event control block. One task is able to wait for several events to occur: whether while one event occurring or after several events occurred, both of these are sure to wake task up to do event handling.</p> <p>In a multi-task environment, tasks must be synchronized. In the one-to-many synchronization model, a task waits for multiple events. In the many-to-many synchronization model, multiple tasks wait for multiple events.</p> <p>Tasks trigger or wait for events through event control blocks. Events in Huawei LiteOS are used only for task synchronization, and not for data transport.</p> <p>Characteristics of events in Huawei LiteOS are as follows:</p> <ul><li><p>Events are not associated with tasks and are independent from each other. A 32-bit variable is used to indicate the type of the event in which a task is interested. Each bit indicates one event type with 0 indicating that the event does not occur and 1 indicating that the event occurs. There are 31 bits that indicate event types (bit 25 is reserved).</p></li> <li><p>Events are used only for task synchronization, and not for data transport.</p></li> <li><p>Sending the same event type to a task for multiple times is equivalent to sending for only once.</p></li> <li><p>Multiple tasks are allowed to read or write the same event.</p></li> <li><p>Huawei LiteOS supports event reading and writing timeout.</p></li></ul> <h4 id="event-control-block"><a href="#event-control-block" aria-hidden="true" class="header-anchor">#</a> Event control block</h4> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/**
 * @ingroup los_event
 * Event control structure
 */</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> tagEvent
<span class="token punctuation">{</span>
    UINT32 uwEventID<span class="token punctuation">;</span>            <span class="token comment">/**bit that indicates an event type*/</span>
    LOS_DL_LIST    stEventList<span class="token punctuation">;</span>  <span class="token comment">/**linked list of  event reading tasks*/</span>
<span class="token punctuation">}</span> EVENT_CB_S<span class="token punctuation">,</span> <span class="token operator">*</span>PEVENT_CB_S<span class="token punctuation">;</span>
</code></pre></div><p><code>uwEventID</code>: Indicates the type of the event in which a task is interested. Each bit indicates one event type with 0 indicating that the event does not occur and 1 indicating that the event occurs. There are 31 bits that indicate event types (bit 25 is reserved).</p> <h4 id="event-reading-mode"><a href="#event-reading-mode" aria-hidden="true" class="header-anchor">#</a> Event reading mode</h4> <p>An event reading mode can be configured during event reading. Event reading modes are as follows:</p> <ul><li><p><code>LOS_WAITMODE_AND</code>: Indicates that event of all event types specified by a mask need to be read. Event reading succeeds only when all events that are read occur.</p></li> <li><p><code>LOS_WAITMODE_OR</code>: Indicates that an event of an event type specified by a mask needs to be read. Event reading succeeds when the event that is read occurs.</p></li> <li><p><code>LOS_WAITMODE_CLR</code>: Indicates that after successful event reading, the event types or event type that is read is automatically cleared.</p></li></ul> <h3 id="operation-mechanism"><a href="#operation-mechanism" aria-hidden="true" class="header-anchor">#</a> Operation Mechanism</h3> <p>During event reading, one type or multiple types specified by uwEventMask are read. After event reading succeeds, the event type that is read is explicitly cleared if <code>LOS_WAITMODE_CLR</code> is configured in the event reading mode. The event type that is not cleared if <code>LOS_WAITMODE_CLR</code> is not configured. You can configure the event reading mode by passing in <code>LOS_WAITMODE_AND</code> to read all events of the event types specified by the event mask or by passing in <code>LOS_WAITMODE_OR</code> to read an event of an event type specified by the event mask.</p> <p>During event writing, a specified event type is written into an event. Multiple event types can be written concurrently. Event writing may trigger task scheduling.</p> <p>During event clearance, the bit that specifies the event type to be cleared is set to 0.</p> <p>Tasks woken up by events</p> <p><img src="/assets/img/event-wakeup.88d386bb.png" alt></p> <h2 id="development-guidelines"><a href="#development-guidelines" aria-hidden="true" class="header-anchor">#</a> Development Guidelines</h2> <h3 id="usage-scenarios"><a href="#usage-scenarios" aria-hidden="true" class="header-anchor">#</a> Usage Scenarios</h3> <p>Events are applicable in a variety of task synchronization scenarios and are partially similar to semaphore in purpose.</p> <h3 id="functions"><a href="#functions" aria-hidden="true" class="header-anchor">#</a> Functions</h3> <p>The event module provides the following functions:</p> <table><thead><tr><th>Function Category</th> <th>API</th> <th>Description</th></tr></thead> <tbody><tr><td>Event initialization</td> <td>LOS_EventInit</td> <td>Initializes an event control block</td></tr> <tr><td>Event reading</td> <td>LOS_EventRead</td> <td>Reads an event within N ticks</td></tr> <tr><td>Event writing</td> <td>LOS_EventWrite</td> <td>Writes an event</td></tr> <tr><td>Event clearance</td> <td>LOS_EventClear</td> <td>Clears an event</td></tr> <tr><td>Event mask verification</td> <td>LOS_EventPoll</td> <td>Determines whether an event meets the expectations based on the passed-in event value, event mask, and verification mode</td></tr> <tr><td>Event destroying</td> <td>LOS_EventDestroy</td> <td>Destroys a specified event control block</td></tr></tbody></table> <h3 id="development-process"><a href="#development-process" aria-hidden="true" class="header-anchor">#</a> Development Process</h3> <p>Typical process of using the event module:</p> <ol><li><p>Call the <code>LOS_EventInit</code> API to initialize an event control block.</p></li> <li><p>Call the <code>LOS_EventInit</code> to write an event.</p></li> <li><p>Call the <code>LOS_EventRead</code> API to read an event.</p></li> <li><p>Call the <code>LOS_EventClear</code> API to clear an event.</p></li></ol> <h2 id="precautions"><a href="#precautions" aria-hidden="true" class="header-anchor">#</a> Precautions</h2> <ul><li><p>Do not make calls to the <code>LOS_EventRead</code> and <code>LOS_EventWrite</code> APIs prior to the operating system being initialized. Otherwise, the operating system exhibits unexpected behavior.</p></li> <li><p>While an interrupt is underway, events can be written into an event control block but event reads are not allowed.</p></li> <li><p>Task blocking and event reading are not allowed while task scheduling is locked.</p></li> <li><p>The input parameter of <code>LOS_EventClear</code> is <code>~uwEvents</code> (reverse code of event type).</p></li> <li><p>Bit 25 of the event mask is merely used to distinguish whether the <code>LOS_EventRead</code> API returns an event or error code.</p></li></ul> <h2 id="programming-example"><a href="#programming-example" aria-hidden="true" class="header-anchor">#</a> Programming Example</h2> <h3 id="example-description"><a href="#example-description" aria-hidden="true" class="header-anchor">#</a> Example Description</h3> <p>In the programming example, the <code>Example_TaskEntry</code> task is executed to create the <code>Example_Event</code> task. The <code>Example_Event</code> task is blocked from reading events. The <code>Example_TaskEntry</code> task writes an event in which the Example_Event task shows interest.</p> <ol><li><p>The <code>Example_TaskEntry</code> task is executed to create the <code>Example_Event</code> task. The <code>Example_Event</code> task takes a higher priority than the <code>Example_TaskEntry</code> task.</p></li> <li><p>The <code>Example_Event</code> task is blocked from reading the event 0x00000001. After the <code>Example_Event</code> task is blocked, a task switch occurs to execute the task with a lower priority, namely, the <code>Example_TaskEntry</code> task.</p></li> <li><p>The <code>Example_TaskEntry</code> task writes the event 0x00000001 toward the  <code>Example_Event</code> task. The <code>Example_Event</code> task is interested in the event 0x00000001 and is therefore woken up to process the event.</p></li> <li><p>The <code>Example_Event</code> task is executed.</p></li> <li><p>The <code>Example_TaskEntry</code> task is executed.</p></li></ol> <h3 id="example-code"><a href="#example-code" aria-hidden="true" class="header-anchor">#</a> Example Code</h3> <p>The order in which print-out is generated provides some clues into task switches that occur during event operations.</p> <p>The code is as follows:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/* task pid */</span>
<span class="token keyword">static</span> UINT32 g_TestTaskID<span class="token punctuation">;</span>
<span class="token comment">/* event control struct */</span>
<span class="token keyword">static</span> EVENT_CB_S  example_event<span class="token punctuation">;</span>

<span class="token comment">/* wait event type */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> event_wait 0x00000001</span>

<span class="token comment">/* example task entry function */</span>
VOID <span class="token function">Example_Event</span><span class="token punctuation">(</span>VOID<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    UINT32 uwEvent<span class="token punctuation">;</span>
    UINT32 uwRet <span class="token operator">=</span> LOS_OK<span class="token punctuation">;</span>

    <span class="token comment">/*
     * timeout, WAITMODE to read event, timeout is 100 ticks,
     * if timeout, wake task directly
     */</span>
    <span class="token function">dprintf</span><span class="token punctuation">(</span><span class="token string">&quot;Example_Event wait event 0x%x \n&quot;</span><span class="token punctuation">,</span>event_wait<span class="token punctuation">)</span><span class="token punctuation">;</span>

    uwEvent <span class="token operator">=</span> <span class="token function">LOS_EventRead</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>example_event<span class="token punctuation">,</span> event_wait<span class="token punctuation">,</span> LOS_WAITMODE_AND<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>uwEvent <span class="token operator">==</span> event_wait<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">dprintf</span><span class="token punctuation">(</span><span class="token string">&quot;Example_Event,read event :0x%x\n&quot;</span><span class="token punctuation">,</span>uwEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        uwRet <span class="token operator">=</span> <span class="token function">LOS_InspectStatusSetByID</span><span class="token punctuation">(</span>LOS_INSPECT_EVENT<span class="token punctuation">,</span> LOS_INSPECT_STU_SUCCESS<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>LOS_OK <span class="token operator">!=</span> uwRet<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">dprintf</span><span class="token punctuation">(</span><span class="token string">&quot;Set Inspect Status Err\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
        <span class="token function">dprintf</span><span class="token punctuation">(</span><span class="token string">&quot;Example_Event,read event timeout\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        uwRet <span class="token operator">=</span> <span class="token function">LOS_InspectStatusSetByID</span><span class="token punctuation">(</span>LOS_INSPECT_EVENT<span class="token punctuation">,</span> LOS_INSPECT_STU_ERROR<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>LOS_OK <span class="token operator">!=</span> uwRet<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">dprintf</span><span class="token punctuation">(</span><span class="token string">&quot;Set Inspect Status Err\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

UINT32 <span class="token function">Example_SndRcvEvent</span><span class="token punctuation">(</span>VOID<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    UINT32 uwRet<span class="token punctuation">;</span>
    TSK_INIT_PARAM_S stTask1<span class="token punctuation">;</span>

    <span class="token comment">/* event init */</span>
    uwRet <span class="token operator">=</span> <span class="token function">LOS_EventInit</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>example_event<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>uwRet <span class="token operator">!=</span> LOS_OK<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">dprintf</span><span class="token punctuation">(</span><span class="token string">&quot;init event failed .\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> LOS_NOK<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/* create task */</span>
    <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>stTask1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>TSK_INIT_PARAM_S<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    stTask1<span class="token punctuation">.</span>pfnTaskEntry <span class="token operator">=</span> <span class="token punctuation">(</span>TSK_ENTRY_FUNC<span class="token punctuation">)</span>Example_Event<span class="token punctuation">;</span>
    stTask1<span class="token punctuation">.</span>pcName       <span class="token operator">=</span> <span class="token string">&quot;EventTsk1&quot;</span><span class="token punctuation">;</span>
    stTask1<span class="token punctuation">.</span>uwStackSize  <span class="token operator">=</span> LOSCFG_BASE_CORE_TSK_DEFAULT_STACK_SIZE<span class="token punctuation">;</span>
    stTask1<span class="token punctuation">.</span>usTaskPrio   <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    uwRet <span class="token operator">=</span> <span class="token function">LOS_TaskCreate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>g_TestTaskID<span class="token punctuation">,</span> <span class="token operator">&amp;</span>stTask1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>uwRet <span class="token operator">!=</span> LOS_OK<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">dprintf</span><span class="token punctuation">(</span><span class="token string">&quot;task create failed .\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> LOS_NOK<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/* write event */</span>
    <span class="token function">dprintf</span><span class="token punctuation">(</span><span class="token string">&quot;Example_TaskEntry_Event write event .\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    uwRet <span class="token operator">=</span> <span class="token function">LOS_EventWrite</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>example_event<span class="token punctuation">,</span> event_wait<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>uwRet <span class="token operator">!=</span> LOS_OK<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">dprintf</span><span class="token punctuation">(</span><span class="token string">&quot;event write failed .\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> LOS_NOK<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/* clear event flag */</span>
    <span class="token function">dprintf</span><span class="token punctuation">(</span><span class="token string">&quot;EventMask:%d\n&quot;</span><span class="token punctuation">,</span> example_event<span class="token punctuation">.</span>uwEventID<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">LOS_EventClear</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>example_event<span class="token punctuation">,</span> <span class="token operator">~</span>example_event<span class="token punctuation">.</span>uwEventID<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">dprintf</span><span class="token punctuation">(</span><span class="token string">&quot;EventMask:%d\n&quot;</span><span class="token punctuation">,</span> example_event<span class="token punctuation">.</span>uwEventID<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> LOS_OK<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="verification"><a href="#verification" aria-hidden="true" class="header-anchor">#</a> Verification</h3> <p>The verification result is as follows:</p> <p><img src="data:image/png;base64,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" alt></p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/LiteOS/LiteOS_Documents/edit/master/docs/en/kernel/event.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">8/5/2018, 5:13:25 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/en/kernel/queue.html" class="prev">
          Queue
        </a></span> <span class="next"><a href="/en/kernel/mutex.html">
          Mutex
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/22.f7638af3.js" defer></script><script src="/assets/js/app.c71e3eab.js" defer></script>
  </body>
</html>
